---
title: "Group document"
format: 
  html: 
    embed-resources: true
editor: visual
---

### Libraries

```{r}
library("tidyverse")
library("broom")
library("patchwork")
```

### Loading the data

```{r}
#| error: false
#| warning: false
biopsy <- read_csv("https://wilkelab.org/classes/SDS348/data_sets/biopsy.csv")
```

### Data Analysis

```{r}
#| error: false
#| warning: false
pca_fit <- biopsy |>
  select(where(is.numeric)) |> # retain only numeric columns
  scale() |> # scale data
  prcomp() # do PCA

pca_fit |>
  augment(biopsy) |> # add original dataset back in
  ggplot(aes(x = .fittedPC1, 
             y = .fittedPC2, 
             color = outcome)) + 
  geom_point(size = 1.5) +
  scale_color_manual(
    values = c(malignant = "#D55E00", 
               benign = "#0072B2")
  ) +
  theme_bw()+
  labs(title = "PC2 vs PC1",
       subtitle = "Stratified via outcome",
       x = "PC1",
       y = "PC2",
       color = "Outcome")

```
